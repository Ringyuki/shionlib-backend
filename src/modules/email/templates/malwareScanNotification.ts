import { I18nService } from 'nestjs-i18n'
import { MalwareScanNotificationData } from '../interfaces/email.interface'

export const generateMalwareScanNotificationTemplate = (
  i18n: I18nService,
  data: MalwareScanNotificationData,
): string => {
  const virusList = data.detectedViruses.length > 0 ? data.detectedViruses.join(', ') : '-'

  return `
    <div style="font-family: Arial, sans-serif; max-width: 640px; margin: 0 auto;">
      <h2 style="color: #d9534f;">${i18n.t('message.email.MALWARE_SCAN_NOTIFICATION_SUBJECT')}</h2>
      <p>${i18n.t('message.email.MALWARE_SCAN_NOTIFICATION_INTRO')}</p>

      <div style="background-color: #f5f5f5; padding: 20px; margin: 20px 0; border-radius: 8px;">
        <table style="width: 100%; border-collapse: collapse;">
          <tr>
            <td style="padding: 8px 0; color: #666; width: 180px;">${i18n.t('message.email.MALWARE_CASE_ID')}:</td>
            <td style="padding: 8px 0; font-weight: bold;">#${data.caseId}</td>
          </tr>
          <tr>
            <td style="padding: 8px 0; color: #666;">${i18n.t('message.email.FILE_NAME')}:</td>
            <td style="padding: 8px 0;">${data.fileName}</td>
          </tr>
          <tr>
            <td style="padding: 8px 0; color: #666;">${i18n.t('message.email.UPLOADER')}:</td>
            <td style="padding: 8px 0;">${data.uploaderName}</td>
          </tr>
          <tr>
            <td style="padding: 8px 0; color: #666;">${i18n.t('message.email.GAME')}:</td>
            <td style="padding: 8px 0;">${data.gameTitle}</td>
          </tr>
          <tr>
            <td style="padding: 8px 0; color: #666;">${i18n.t('message.email.DETECTED_VIRUSES')}:</td>
            <td style="padding: 8px 0;">${virusList}</td>
          </tr>
          <tr>
            <td style="padding: 8px 0; color: #666;">${i18n.t('message.email.REVIEW_DEADLINE')}:</td>
            <td style="padding: 8px 0;">${data.reviewDeadline.toISOString()}</td>
          </tr>
        </table>
      </div>

      <div style="text-align: center; margin: 30px 0;">
        <a href="${data.adminReviewUrl}"
           style="background-color: #34a2d5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;">
          ${i18n.t('message.email.REVIEW_MALWARE_CASE')}
        </a>
      </div>

      <p style="color: #999; font-size: 12px;">${i18n.t('message.email.REPORT_NOTIFICATION_FOOTER')}</p>
    </div>
  `
}
